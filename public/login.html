<script>
    document.getElementById("loginForm").addEventListener("submit", async (e) => {
        e.preventDefault();
    
        const userId = document.getElementById("userId").value.trim();
        const password = document.getElementById("password").value.trim();
    
        if (!userId || !password) {
            alert("Vă rugăm să introduceți ID-ul și parola.");
            return;
        }
    
        try {
            const response = await fetch("/login", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ userId, password }),
            });
    
            const data = await response.json();
            if (response.ok) {
                localStorage.setItem("token", data.token);
                localStorage.setItem("role", data.role);
                localStorage.setItem("userId", data.userId);
                localStorage.setItem("name", data.name);
    
                window.location.href = "/dashboard";
            } else {
                document.getElementById("errorMessage").innerText = data.error || "Eroare la conectare.";
            }
        } catch (error) {
            document.getElementById("errorMessage").innerText = "Eroare de rețea.";
        }
    });
</script>
